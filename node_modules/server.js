var fs = require("fs");
var xss = require("xss");

var sysDisk = "cdefghijklmnopqrstuvwxyz".toUpperCase().split("");

function getSysHostPath(){
  var i = 0;
  var len = sysDisk.length;
  var p = ':/Windows/System32/drivers/etc/hosts';
  var hostPath = '';

  for(; i<len; i++){
    hostPath = sysDisk[i] + p;
    
    try{
      fs.readFileSync(hostPath);
      break;
    }catch(e){
      continue;
    }
  }

  return hostPath;
}

//因为有可能不是C盘
var sysHostPath = getSysHostPath();

function PHost(){}

PHost.prototype = {
  getSysHost : function(){
    return fs.readFileSync(sysHostPath);
  },

  setSysHost : function(data){
    fs.writeFileSync(sysHostPath, data);
  },

  filterXss : function(data){
    data = data.replace(/[<>'"]/g, '');
    return xss(data);
  },

  getSysHostPath : function(){
    return getSysHostPath();
  }
}

exports.PHost = new PHost();
